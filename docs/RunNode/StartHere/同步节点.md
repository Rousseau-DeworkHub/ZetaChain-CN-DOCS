| 标题     | 描述                        |
| :------- | :-------------------------- |
| 同步节点 | 使用快照或 KSYNC 同步节点。 |

本指南假设你已完成 [节点设置](/nodes/start-here/setup) 步骤。

# 选项 1：快照方法

此方法通过下载现有节点的备份数据目录来进行同步。

选择网络和快照类型，下载并将快照解压到 `/home/zetachain/.zetacored` 目录中。

## 下载最新完整节点快照

以下命令将下载并解压最新的完整节点快照：

```bash
# 确保已安装 lz4
sudo apt update && sudo apt install lz4 -y

# 获取 JSON 响应
SNAPSHOT_JSON=$(curl -s https://snapshots.rpc.zetachain.com/mainnet/fullnode/latest.json)

# 提取链接和文件名
SNAPSHOT_LINK=$(echo $SNAPSHOT_JSON | jq -r '.snapshots[].link')
SNAPSHOT_FILENAME=$(echo $SNAPSHOT_JSON | jq -r '.snapshots[].filename')

# 下载并解压快照
sudo -u zetachain curl "$SNAPSHOT_LINK" -o "/home/zetachain/$SNAPSHOT_FILENAME" && sudo -u zetachain lz4 -dc /home/zetachain/$SNAPSHOT_FILENAME | sudo -u zetachain tar -C /home/zetachain/.zetacored/ -xvf - && sudo systemctl start zetacored
```

> 节点名单请参考原文： [节点快照](https://www.zetachain.com/docs/nodes/start-here/syncing#download-the-latest-full-node-snapshot) 
>

>我们的 **归档快照** 现已提供为 **多分片（multipart）格式**。你可以点击 **“Show Parts”** 单独下载各个部分，
>   或复制下方提供的 **POSIX 下载脚本** 一键下载、打包并解压整个快照。
>   点击分片列表下方的 **“Copy to Clipboard”** 图标，即可复制命令并在终端中运行。


  快照数据库后端为 **pebbledb**。请确保你的节点使用相同的后端以便正常使用这些快照。

#### 其他快照来源

##### 主网：

- https://polkachu.com/tendermint_snapshots/zetachain
- https://app.nodejumper.io/zetachain/sync
- https://itrocket.net/services/mainnet/zetachain/#snap

##### 测试网：

- https://app.nodejumper.io/zetachain-testnet/sync
- https://itrocket.net/services/testnet/zetachain/#snap

# 选项 2：使用 KYVE 的 KSYNC 方法

以下内容介绍如何通过 KSYNC 同步 ZetaChain 主网节点的详细步骤。

KSYNC 是一款工具，可将区块和状态同步快照从去中心化的 KYVE 数据湖直接同步至 Cosmos 区块链节点。
借助 KSYNC，Cosmos 验证者无需等待节点互联即可完成区块同步，也无需手动查找可信 app hash 来进行状态同步。
此外，还支持从创世区块（genesis）开始的历史状态同步。

更多关于 KSYNC 的信息请参阅：https://docs.kyve.network/ksync

### 安装 KSYNC

安装最新版本的 KSYNC：

```
go install github.com/KYVENetwork/ksync/cmd/ksync@latest
```

验证安装：

```
ksync version
```

### 配置节点

修改 `config.toml` 文件中的以下配置：

```text filename="/home/zetachain/.zetacored/config/config.toml"
db_backend = "goleveldb"
```

暂时需要将 db_backend 改为默认的 goleveldb，因为 KSYNC 目前尚未支持 ZetaChain 所依赖的 pebbledb 数据库。
参考：https://github.com/BlockPILabs/cosmos-db

### 同步节点

```
ksync state-sync --binary="/path/to/zetacored" --chain-id=zetachain_7000-1 --snapshot-pool-id=11
```

# 检查节点状态

### 查询节点状态

可通过以下命令确认节点是否已同步：

```
curl http://localhost:26657/status | jq
```

确保 `catching_up` 值为 false。同时检查 `latest_block_height` 与 `latest_block_time`。

### 检查日志

要确认节点是否正常运行，可查看日志。正常节点会打印类似如下的 `INF` 日志：

```
4:10AM INF executed block height=3468229 module=state num_invalid_txs=1 num_valid_txs=24 server=node
4:10AM INF commit synced commit=436F6D6D697449447B5B3139332032323120323438203430203230
4:10AM INF committed state app_hash=C1DDF828CB4126E8239D92FB57006D978664911BF75FDB2606804083C4F65354 height=3468229
4:10AM INF indexed block events height=3468229 module=txindex server=node
4:11AM INF Timed out dur=4468.382473 height=3468230 module=consensus round=0 server=node step=1
```
